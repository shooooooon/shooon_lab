# SHooon Lab - Project TODO

## 基本機能
- [x] データベーススキーマ設計
- [x] 記事テーブル（articles）
- [x] タグテーブル（tags）
- [x] シリーズテーブル（series）
- [x] コメントテーブル（comments）
- [x] 記事タグ関連テーブル（article_tags）
- [x] バックエンドAPI実装
- [x] 記事CRUD API
- [x] タグCRUD API
- [x] シリーズCRUD API
- [x] コメントCRUD API
- [x] アーカイブAPI（年別集計）
- [x] 特集記事API（重み付け対応）
- [x] 検索API（全文検索）
- [x] フロントエンド基盤
- [x] レイアウトコンポーネント
- [x] ナビゲーションヘッダー
- [x] フッター
- [x] テーマ設定（配色）
- [x] ホームページ
- [x] 特集記事スライダー
- [x] 最新記事一覧
- [x] 記事詳細ページ
- [x] Markdown本文表示
- [x] 脚注表示
- [x] ギャラリー表示
- [x] シリーズナビゲーション
- [x] 共有機能
- [x] コメントシステム
- [x] スレッドコメント表示
- [x] コメント投稿フォーム
- [x] 返信機能
- [x] アーカイブブラウザ
- [x] 年別フィルター
- [x] タグフィルター
- [x] シリーズフィルター
- [x] ページネーション
- [x] 検索ページ
- [x] 管理者機能
- [x] 管理者ダッシュボード
- [x] 記事一覧・管理
- [x] 記事作成・編集エディター
- [x] コメントモデレーション
- [x] タグ管理
- [x] シリーズ管理
- [x] テスト
- [x] API権限テスト
- [x] 認証テスト

## CODE_REVIEW改善項目

### 最優先（セキュリティ）
- [x] #1: SQLインジェクション対策 - パラメータ化クエリ使用
- [x] #17: 管理者権限チェック - adminProcedure使用

### 高優先度（バグ・パフォーマンス）
- [x] #2: 入力バリデーション - Zodスキーマ強化
- [x] #4: コメント返信フォームバグ - 返信フォームをCommentThread内に移動
- [x] #6: N+1クエリ問題 - JOINクエリ最適化

### 中優先度（型安全性・データ整合性）
- [x] #3: 型キャスト改善 - as unknown as 削除
- [x] #5: LIKEワイルドカードエスケープ
- [x] #8: ユニーク制約追加（slug, name）
- [x] #9: 外部キー制約追加
- [x] #10: DB初期化パターン改善
- [x] #11: getArchiveYears型安全性
- [x] #12: ビューカウント副作用分離

### 低優先度（コード品質）
- [x] #7: 重複コード削除
- [x] #13: ArticleCard共通化
- [x] #14: エラーメッセージ定数化
- [x] #15: 日本語スラッグ対応
- [x] #16: マジックナンバー定数化
- [x] #18: console.log削除

## CODE_REVIEW第2版改善項目

### 高優先度
- [x] #A: ビューカウント重複実行リスク - useRefでガード追加
- [x] #B: Archive/SearchのArticleCard共通化 - ArticleCardHorizontal使用

### 中優先度
- [x] #C: getArchiveYears型キャスト改善 - ArchiveYearRowインターフェース定義
- [x] #D: テストアサーション強化 - NOT_ADMIN_ERR_MSG定数使用

## PRODUCTION_READINESS改善項目

### 致命的（デプロイ前に必須）
- [x] P1: 環境変数バリデーション - requireEnv/optionalEnv関数追加
- [x] P2: helmet（セキュリティヘッダー）追加
- [x] P3: レート制限（express-rate-limit）追加
- [x] P4: Cookie sameSite設定を"lax"に変更
- [x] P5: グレースフルシャットダウン実装
- [x] P6: trust proxy設定

### 高優先度
- [x] P10: ヘルスチェックDB疎通確認
- [x] P11: 構造化ログ（pino）

### 中優先度
- [x] P12: 静的ファイルキャッシュヘッダー
- [x] P13: gzip圧縮
